{"mappings":"woBAAe,MAAMA,EAOkBC,SAA5BC,GACP,MAAMC,EAAmBC,aAAaC,QAAQH,GAC9C,OAAOI,KAAKC,MAAMJ,E,CAIiBK,SAA5BN,EAAKO,GACZ,MAAMC,EAAaJ,KAAKK,UAAUF,GAElC,OADAL,aAAaQ,QAAQV,EAAKQ,GACnB,I,CAIkFG,UAAjFX,EAAKY,EAAO,GACpB,MAAMC,EAASC,KAAKf,SAASC,GACvBe,EAAaD,KAAKE,cAAcH,GAMtC,MALe,CACbA,OAAQC,KAAKG,kBAAkBL,EAAMC,G,KACrCD,E,WACAG,E,CAMJG,SAASlB,EAAKO,GACRO,KAAKK,WAAWZ,EAAMa,MAAQN,KAAKO,UAAUrB,IAC/Cc,KAAKQ,YAAYR,KAAKO,UAAUrB,GAAMO,EAAMa,IAE9C,IACE,MAAMG,EAAoBT,KAAKH,UAAUX,GAAKa,OAE9C,OADAU,EAAkBC,KAAKjB,GAChBO,KAAKR,SAASN,EAAKuB,E,CAC1B,MAAOE,GACPC,QAAQC,IAAIF,EAAMG,MAClBF,QAAQC,IAAIF,EAAMI,Q,EAItBP,YAAYtB,EAAKoB,GACf,MAAMG,EAAoBT,KAAKH,UAAUX,GAAKa,OAExCiB,EADuBP,EAAkBQ,KAAIC,GAAQA,EAAKZ,KACrBa,QAAQb,GAC/CU,GAAiB,IACnBP,EAAkBW,OAAOJ,EAAe,GACxChB,KAAKR,SAASN,EAAKuB,G,CAIvBP,cAAcH,GACZ,OAAOsB,KAAKC,KAAKvB,EAAOwB,OAAS,G,CAGnCpB,kBAAkBL,EAAM0B,GAEtB,IAAIC,EADY,IACH3B,EAAO,GAChB4B,EAAMD,EAFM,GAGhB,OAAOD,EAAMG,MAAMF,EAAOC,E,CAG5BE,aAAaJ,GACX,MAAMK,EAAS7B,KAAKf,SAAS,UAC7B,OAAOuC,EACJP,KAAIX,GAAMuB,EAAOC,MAAKC,GAAWA,EAAQzB,KAAOA,MAChDW,KAAIC,GAAQA,EAAKJ,M,CAGtBT,WAAWC,GACT,IACIG,EACAuB,EAFAC,EAAwB,KAa5B,OAVAxB,EAAoBT,KAAKH,UAAU,WAAWE,OAC9CiC,EAAuBvB,EAAkBQ,KAAIC,GAAQA,EAAKZ,KACtD0B,EAAqBE,SAAS5B,KAChC2B,EAAwB,WAE1BxB,EAAoBT,KAAKH,UAAU,SAASE,OAC5CiC,EAAuBvB,EAAkBQ,KAAIC,GAAQA,EAAKZ,KACtD0B,EAAqBE,SAAS5B,KAChC2B,EAAwB,SAEnBA,C,CAGT1B,UAAUrB,GACR,MAAe,YAARA,EAAoB,QAAU,S,CA3FvCiD,cACOnC,KAAKf,SAAS,YAAYe,KAAKR,SAAS,UAAW,IAAI4C,OAAO,KAC9DpC,KAAKf,SAAS,UAAUe,KAAKR,SAAS,QAAS,IAAI4C,OAAO,I","sources":["src/js/services/local-storage-api.js"],"sourcesContent":["export default class LocalStorageAPI {\n  constructor() {\n    if (!this.loadData('watched')) this.saveData('watched', new Object([]));\n    if (!this.loadData('queue')) this.saveData('queue', new Object([]));\n  }\n\n  // Отримання даних за ключем. Повертає дані, або null\n  loadData(key) {\n    const localStorageData = localStorage.getItem(key);\n    return JSON.parse(localStorageData);\n  }\n\n  // Запис даних до сховища. Записує дані з ключем key\n  saveData(key, value) {\n    const dataToSave = JSON.stringify(value);\n    localStorage.setItem(key, dataToSave);\n    return 'ok';\n  }\n\n  // Отримання колекції фільмів. Повертає масив фільмів, або порожній масив з його попереднім записом до сховища\n  getMovies(key, page = 1) {\n    const movies = this.loadData(key); // отр\n    const totalPages = this.getTotalPages(movies);\n    const result = {\n      movies: this.getPaginationPage(page, movies),\n      page,\n      totalPages,\n    };\n    return result;\n  }\n\n  // Додавання фільмів до колекції. Додає новий елемент до поточної колекції фільмів у сховищі\n  setMovie(key, value) {\n    if (this.checkMovie(value.id) === this.changeKey(key))\n      this.removeMovie(this.changeKey(key), value.id);\n\n    try {\n      const currentCollection = this.getMovies(key).movies;\n      currentCollection.push(value);\n      return this.saveData(key, currentCollection);\n    } catch (error) {\n      console.log(error.name);\n      console.log(error.message);\n    }\n  }\n\n  removeMovie(key, id) {\n    const currentCollection = this.getMovies(key).movies;\n    const currentCollectionIds = currentCollection.map(item => item.id);\n    const indexToRemove = currentCollectionIds.indexOf(id);\n    if (indexToRemove >= 0) {\n      currentCollection.splice(indexToRemove, 1);\n      this.saveData(key, currentCollection);\n    }\n  }\n\n  getTotalPages(movies) {\n    return Math.ceil(movies.length / 20);\n  }\n\n  getPaginationPage(page, array) {\n    const perPage = 20;\n    let start = (page - 1) * perPage;\n    let end = start + perPage;\n    return array.slice(start, end);\n  }\n\n  createGenres(array) {\n    const genres = this.loadData('genres');\n    return array\n      .map(id => genres.find(element => element.id === id))\n      .map(item => item.name);\n  }\n\n  checkMovie(id) {\n    let isMovieInLocalStorage = 'no';\n    let currentCollection;\n    let currentCollectionIds;\n    currentCollection = this.getMovies('watched').movies;\n    currentCollectionIds = currentCollection.map(item => item.id);\n    if (currentCollectionIds.includes(id)) {\n      isMovieInLocalStorage = 'watched';\n    }\n    currentCollection = this.getMovies('queue').movies;\n    currentCollectionIds = currentCollection.map(item => item.id);\n    if (currentCollectionIds.includes(id)) {\n      isMovieInLocalStorage = 'queue';\n    }\n    return isMovieInLocalStorage;\n  }\n\n  changeKey(key) {\n    return key === 'watched' ? 'queue' : 'watched';\n  }\n}\n"],"names":["$c823243da5249566$export$2e2bcd8739ae039","loadData","key","localStorageData","localStorage","getItem","JSON","parse","saveData","value","dataToSave","stringify","setItem","getMovies","page","movies","this","totalPages","getTotalPages","getPaginationPage","setMovie","checkMovie","id","changeKey","removeMovie","currentCollection","push","error","console","log","name","message","indexToRemove","map","item","indexOf","splice","Math","ceil","length","array","start","end","slice","createGenres","genres","find","element","currentCollectionIds","isMovieInLocalStorage","includes","constructor","Object"],"version":3,"file":"library.971ab719.js.map"}